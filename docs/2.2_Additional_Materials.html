
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Additional Materials &#8212; Jupyter Notebook Tutorial</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reuse of winter school practical course material" href="3.1_Reuse_Course_Material.html" />
    <link rel="prev" title="Data Analysis in Jupyter Notebook (Part 2)" href="2.1_Jupyter_Data_Analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Jupyter Notebook Tutorial</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started with Jupyter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.1_Jupyter_Introduction.html">
   Introduction to Jupyter Notebook (Part 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.2_R_Kernel.html">
   Introduction to Juypter - The R kernel
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Practical example in Jupyter
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2.1_Jupyter_Data_Analysis.html">
   Data Analysis in Jupyter Notebook (Part 2)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Additional Materials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation and reusing material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="3.1_Reuse_Course_Material.html">
   Reuse of winter school practical course material
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/2.2_Additional_Materials.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F2.2_Additional_Materials.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/2.2_Additional_Materials.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plant-traits-try-database">
   Plant traits - TRY database
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data">
     Load Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-for-duplicate-names">
     Check for duplicate names
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-summary-stats-with-consolidated-species-name">
     Create summary stats with consolidated species name
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-summary-stats-with-original-name">
     Create summary stats with original name
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#link-inaturalist-to-try">
   Link iNaturalist to TRY
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Additional Materials</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plant-traits-try-database">
   Plant traits - TRY database
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data">
     Load Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-for-duplicate-names">
     Check for duplicate names
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-summary-stats-with-consolidated-species-name">
     Create summary stats with consolidated species name
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-summary-stats-with-original-name">
     Create summary stats with original name
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#link-inaturalist-to-try">
   Link iNaturalist to TRY
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="additional-materials">
<h1>Additional Materials<a class="headerlink" href="#additional-materials" title="Permalink to this headline">#</a></h1>
<section id="plant-traits-try-database">
<h2>Plant traits - TRY database<a class="headerlink" href="#plant-traits-try-database" title="Permalink to this headline">#</a></h2>
<p>The TRY database contains trait measurements from individual plants and, typically, multiple individual measurements per trait and species. We want to extract a mean for each trait value per species.</p>
<p>We have prepared data for this course, however, for future reference, to download data from the TRY database, create an account at <a class="reference external" href="https://www.try-db.org/de">https://www.try-db.org/de</a>.</p>
<p>We choose the option of open access data only, but the curators of this database still require you to add a short project description to your download request. You will then be sent a download link via e-mail.</p>
<p>For this study we will use continuous (con) traits used in the sPlot analysis from Buehlheide et al. 2018:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Trait</p></th>
<th class="text-align:center head"><p>ID</p></th>
<th class="text-align:right head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Leaf area (in case of compound leaves: leaflet, undefined if petiole is in- or excluded)</p></td>
<td class="text-align:center"><p>3113</p></td>
<td class="text-align:right"><p>mm^2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Leaf area per leaf dry mass (specific leaf area, SLA or 1/LMA): undefined if petiole is in- or excluded)</p></td>
<td class="text-align:center"><p>3117</p></td>
<td class="text-align:right"><p>m^2/kg</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Stem specific density (SSD) or wood density (stem dry mass per stem fresh volume)</p></td>
<td class="text-align:center"><p>4</p></td>
<td class="text-align:right"><p>g/cm^3</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Leaf carbon (C) content per leaf dry mass</p></td>
<td class="text-align:center"><p>13</p></td>
<td class="text-align:right"><p>mg/g</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Leaf nitrogen (N) content per leaf dry mass</p></td>
<td class="text-align:center"><p>14</p></td>
<td class="text-align:right"><p>mg/g</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Leaf phosphorus (P) content per leaf dry mass</p></td>
<td class="text-align:center"><p>15</p></td>
<td class="text-align:right"><p>mg/g</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Plant height vegetative</p></td>
<td class="text-align:center"><p>3106</p></td>
<td class="text-align:right"><p>m</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Seed dry mass</p></td>
<td class="text-align:center"><p>26</p></td>
<td class="text-align:right"><p>mg</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Seed length</p></td>
<td class="text-align:center"><p>27</p></td>
<td class="text-align:right"><p>mm</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Leaf dry mass per leaf fresh mass (leaf dry matter content, LDMC)</p></td>
<td class="text-align:center"><p>47</p></td>
<td class="text-align:right"><p>g/g</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Leaf nitrogen (N) content per leaf area</p></td>
<td class="text-align:center"><p>50</p></td>
<td class="text-align:right"><p>g/m^2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Leaf nitrogen/phosphorus (N/P) ratio</p></td>
<td class="text-align:center"><p>56</p></td>
<td class="text-align:right"><p>g/g</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Leaf nitrogen (N) isotope signature (delta 15N)</p></td>
<td class="text-align:center"><p>78</p></td>
<td class="text-align:right"><p>ppm</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Seed number per reproducton unit</p></td>
<td class="text-align:center"><p>138</p></td>
<td class="text-align:right"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Leaf fresh mass</p></td>
<td class="text-align:center"><p>163</p></td>
<td class="text-align:right"><p>g</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Stem conduit density (vessels and tracheids)</p></td>
<td class="text-align:center"><p>169</p></td>
<td class="text-align:right"><p>mm-2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Dispersal unit length</p></td>
<td class="text-align:center"><p>237</p></td>
<td class="text-align:right"><p>mm</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Wood vessel element length; stem conduit (vessel and tracheids) element length</p></td>
<td class="text-align:center"><p>282</p></td>
<td class="text-align:right"><p>Î¼m</p></td>
</tr>
</tbody>
</table>
<p>When asked which traits you would like to download, type in the following list. This filters TRY data for our traits of interest, listed in the table above.</p>
<p><code class="docutils literal notranslate"><span class="pre">3113,</span> <span class="pre">3117,</span> <span class="pre">4,</span> <span class="pre">13,</span> <span class="pre">14,</span> <span class="pre">15,</span> <span class="pre">3106,</span> <span class="pre">26,</span> <span class="pre">27,</span> <span class="pre">47,</span> <span class="pre">50,</span> <span class="pre">56,</span> <span class="pre">78,</span> <span class="pre">138,</span> <span class="pre">163,</span> <span class="pre">169,</span> <span class="pre">237,</span> <span class="pre">282</span></code></p>
<section id="load-data">
<h3>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">#</a></h3>
<p>First, load the TRY data as a data frame, selecting only the following columns:</p>
<ul class="simple">
<li><p><strong>AccSpeciesName</strong> - Consolidated species name</p></li>
<li><p><strong>SpeciesName</strong> - Species name</p></li>
<li><p><strong>TraitID</strong> - Unique identifier for traits (only if the record is a trait)</p></li>
<li><p><strong>TraitName</strong> - Name of trait (only if the record is a trait)</p></li>
<li><p><strong>StdValue</strong> - Standardized value: available for standardized traits</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRYdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Data/iNaturalist/Data/TRY/19287.txt&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="p">,</span> 
                      <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AccSpeciesName&quot;</span><span class="p">,</span> <span class="s2">&quot;SpeciesName&quot;</span><span class="p">,</span> <span class="s2">&quot;TraitID&quot;</span><span class="p">,</span> <span class="s2">&quot;TraitName&quot;</span><span class="p">,</span> <span class="s2">&quot;StdValue&quot;</span><span class="p">],</span>
                     <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TraitID&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2918340/474720487.py:1: DtypeWarning: Columns (10) have mixed types. Specify dtype option on import or set low_memory=False.
  TRYdata = pd.read_csv(&quot;TRY/19287.txt&quot;, sep = &quot;\t&quot;, encoding=&quot;iso-8859-1&quot;,
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRYdata</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SpeciesName</th>
      <th>AccSpeciesName</th>
      <th>TraitID</th>
      <th>TraitName</th>
      <th>StdValue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Acer campestre</td>
      <td>Acer campestre</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Acer campestre</td>
      <td>Acer campestre</td>
      <td>26.0</td>
      <td>Seed dry mass</td>
      <td>14.38</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Acer platanoides</td>
      <td>Acer platanoides</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Acer platanoides</td>
      <td>Acer platanoides</td>
      <td>26.0</td>
      <td>Seed dry mass</td>
      <td>59.90</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Acer pseudoplatanus</td>
      <td>Acer pseudoplatanus</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># drops rows with missing values</span>
<span class="n">TRYdata</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TraitID&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check number of unique trait names</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s2">&quot;TraitID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of unique species</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s2">&quot;AccSpeciesName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54739
</pre></div>
</div>
</div>
</div>
<p>We remove author annotation and subspecies information from species names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make all letters lower case</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="c1"># capitalize first letter in string</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="c1"># get only two first words (split at space)</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]))</span>
<span class="c1"># change type to string</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># same for species name</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51908
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRYdata</span><span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61181
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-for-duplicate-names">
<h3>Check for duplicate names<a class="headerlink" href="#check-for-duplicate-names" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRY_sp</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="p">[</span><span class="s2">&quot;AccSpeciesName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">TRY_sp</span> <span class="o">=</span> <span class="n">TRY_sp</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">TRY_sp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rapidfuzz</span> <span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>

<span class="k">def</span> <span class="nf">fuzzy_match</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">):</span>
    
    <span class="n">score_sort</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,)</span> <span class="o">+</span> <span class="n">i</span>
             <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">queries</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">score_cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">scorer</span><span class="o">=</span><span class="n">fuzz</span><span class="o">.</span><span class="n">token_sort_ratio</span><span class="p">)</span> <span class="p">]</span>
    
    <span class="n">similarity_sort</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">score_sort</span><span class="p">)</span>
    <span class="n">similarity_sort</span> <span class="o">=</span> <span class="n">similarity_sort</span><span class="p">[</span><span class="n">similarity_sort</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">100.0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">similarity_sort</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRY_matches</span> <span class="o">=</span> <span class="n">fuzzy_match</span><span class="p">(</span><span class="n">TRY_sp</span><span class="p">,</span> <span class="n">TRY_sp</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRY_matches</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRY_matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TRY_matches</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">TRY_sp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Only 0.5% of unique species in TRY have potential duplicates (similar names). Since we are looking at vast scales and, we can diregard this slight uncertainty and accept that these species might not be matched to the iNaturalist observations.</p>
<p>We devide the number for matches by 2, since every pair is listed twice (positions switched).</p>
</section>
<section id="create-summary-stats-with-consolidated-species-name">
<h3>Create summary stats with consolidated species name<a class="headerlink" href="#create-summary-stats-with-consolidated-species-name" title="Permalink to this headline">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> function to group data by consolidated species name and trait; grouping variables: <code class="docutils literal notranslate"><span class="pre">AccSpeciesName,</span> <span class="pre">TraitName,</span> <span class="pre">TraitID</span></code>.</p>
<p>More information: <a class="reference external" href="https://www.tutorialspoint.com/python_pandas/python_pandas_groupby.htm">https://www.tutorialspoint.com/python_pandas/python_pandas_groupby.htm</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group data by species name and trait</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">,</span> <span class="s1">&#39;TraitID&#39;</span><span class="p">,</span> <span class="s1">&#39;TraitName&#39;</span><span class="p">])</span>
<span class="n">TRY</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;StdValue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1">#check output</span>
<span class="n">TRY</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AccSpeciesName</th>
      <th>TraitID</th>
      <th>TraitName</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aa</td>
      <td>14.0</td>
      <td>Leaf nitrogen (N) content per leaf dry mass</td>
      <td>26.400000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aa</td>
      <td>50.0</td>
      <td>Leaf nitrogen (N) content per leaf area</td>
      <td>2.798400</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Aa</td>
      <td>3117.0</td>
      <td>Leaf area per leaf dry mass (specific leaf are...</td>
      <td>9.433962</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Aaronsohnia pubescens</td>
      <td>3106.0</td>
      <td>Plant height vegetative</td>
      <td>0.200000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Abacaba (palm)</td>
      <td>3106.0</td>
      <td>Plant height vegetative</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shorten_names</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Stem specific density (SSD) or wood density (stem dry mass per stem fresh volume)&#39;</span><span class="p">:</span><span class="s1">&#39;SSD&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf carbon (C) content per leaf dry mass&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf C&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf nitrogen (N) content per leaf dry mass&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf N per mass&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf phosphorus (P) content per leaf dry mass&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf P&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf dry mass per leaf fresh mass (leaf dry matter content, LDMC)&#39;</span><span class="p">:</span><span class="s1">&#39;LDMC&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Seed dry mass&#39;</span><span class="p">:</span><span class="s1">&#39;Seed mass&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Seed length&#39;</span><span class="p">:</span><span class="s1">&#39;Seed length&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf nitrogen (N) content per leaf area&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf N per area&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf nitrogen/phosphorus (N/P) ratio&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf N P ratio&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf nitrogen (N) isotope signature (delta 15N)&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf delta15N&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf fresh mass&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf fresh mass&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Seed number per reproducton unit&#39;</span><span class="p">:</span><span class="s1">&#39;Seeds per rep. unit&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Stem conduit density (vessels and tracheids)&#39;</span><span class="p">:</span><span class="s1">&#39;Stem conduit density&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Dispersal unit length&#39;</span><span class="p">:</span><span class="s1">&#39;Dispersal unit length&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Wood vessel element length; stem conduit (vessel and tracheids) element length&#39;</span><span class="p">:</span><span class="s1">&#39;Conduit element length&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Plant height vegetative&#39;</span><span class="p">:</span><span class="s1">&#39;Plant Height&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf area (in case of compound leaves: leaflet, undefined if petiole is in- or excluded)&#39;</span><span class="p">:</span><span class="s1">&#39;Leaf Area&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Leaf area per leaf dry mass (specific leaf area, SLA or 1/LMA): undefined if petiole is in- or excluded&#39;</span><span class="p">:</span><span class="s1">&#39;SLA&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Change data frame from long to wide using <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.pivot</span></code>. And shorten trait names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRY</span> <span class="o">=</span> <span class="n">TRY</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AccSpeciesName&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;TraitName&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>

<span class="c1"># reset indeces (species name) as columns in data frame</span>
<span class="n">TRY</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># rename trait variables to shorter names</span>
<span class="n">shorten_names</span><span class="p">(</span><span class="n">TRY</span><span class="p">)</span>

<span class="n">TRY</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>TraitName</th>
      <th>AccSpeciesName</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>Leaf C</th>
      <th>LDMC</th>
      <th>Leaf fresh mass</th>
      <th>Leaf N per area</th>
      <th>Leaf N per mass</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.433962</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.7984</td>
      <td>26.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aaronsohnia pubescens</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Abacaba (palm)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optional: Save file</span>
<span class="c1">#TRY.to_csv(&quot;TRY/TRY_summary_stats.csv&quot;, index=False)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-summary-stats-with-original-name">
<h3>Create summary stats with original name<a class="headerlink" href="#create-summary-stats-with-original-name" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># group data by species name and trait, same analysis as above</span>
<span class="n">grouped_syn</span> <span class="o">=</span> <span class="n">TRYdata</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">,</span> <span class="s1">&#39;TraitID&#39;</span><span class="p">,</span> <span class="s1">&#39;TraitName&#39;</span><span class="p">])</span>

<span class="n">TRY_syn</span> <span class="o">=</span> <span class="n">grouped_syn</span><span class="p">[</span><span class="s1">&#39;StdValue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># change df shape</span>
<span class="n">TRY_syn</span> <span class="o">=</span> <span class="n">TRY_syn</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SpeciesName&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;TraitName&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>

<span class="c1"># reset indeces (species name) as columns in data frame</span>
<span class="n">TRY_syn</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># shorten column names</span>
<span class="n">shorten_names</span><span class="p">(</span><span class="n">TRY_syn</span><span class="p">)</span>

<span class="c1">#optional</span>
<span class="c1">#TRY_syn.to_csv(&quot;TRY/TRY_summary_stats_syn.csv&quot;, index=False)</span>

<span class="n">TRY_syn</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>TraitName</th>
      <th>SpeciesName</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>Leaf C</th>
      <th>LDMC</th>
      <th>Leaf fresh mass</th>
      <th>Leaf N per area</th>
      <th>Leaf N per mass</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(fabaceae)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21.3385</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.578157</td>
      <td>33.150000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(fabaceae) 20-25oblong</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.761453</td>
      <td>32.513864</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(fabaceae) brillafuzzy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.397197</td>
      <td>33.837593</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="link-inaturalist-to-try">
<h2>Link iNaturalist to TRY<a class="headerlink" href="#link-inaturalist-to-try" title="Permalink to this headline">#</a></h2>
<p>Non-fuzzy merge with TRY summary stats on <strong>consolidated TRY species name</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># for handling dataframes in python</span>

<span class="n">iNat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;iNat_observations.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iNat_TRY</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">iNat</span><span class="p">,</span> <span class="n">TRY</span><span class="p">,</span> 
                    <span class="n">left_on</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;scientificName&#39;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">],</span> 
                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">iNat_TRY</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>scientificName</th>
      <th>decimalLatitude</th>
      <th>decimalLongitude</th>
      <th>eventDate</th>
      <th>dateIdentified</th>
      <th>AccSpeciesName</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>...</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1229615436</td>
      <td>Commelina communis</td>
      <td>35.987483</td>
      <td>-79.057546</td>
      <td>2013-07-07T00:00:00</td>
      <td>2013-07-07T20:33:11</td>
      <td>Commelina communis</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3384000233</td>
      <td>Commelina communis</td>
      <td>42.093762</td>
      <td>-75.923660</td>
      <td>2021-08-23T13:06:06</td>
      <td>2021-09-17T21:15:37</td>
      <td>Commelina communis</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1807276585</td>
      <td>Commelina communis</td>
      <td>40.787636</td>
      <td>-73.933728</td>
      <td>2017-09-04T12:47:58</td>
      <td>2017-09-04T21:58:57</td>
      <td>Commelina communis</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows Ã 25 columns</p>
</div></div></div>
</div>
<p>Extract from TRY those observations that have not been matched:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filter for observations not in merged dataframe:</span>
<span class="n">iNat_rest</span> <span class="o">=</span> <span class="n">iNat</span><span class="p">[</span><span class="o">~</span><span class="n">iNat</span><span class="o">.</span><span class="n">gbifID</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">iNat_TRY</span><span class="p">[</span><span class="s1">&#39;gbifID&#39;</span><span class="p">])]</span>
<span class="n">iNat_rest</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2541013, 6)
</pre></div>
</div>
</div>
</div>
<p>We repeat the same with the <strong>âoriginalâ species name</strong> in TRY:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># non-fuzzy merge with TRY summary stats on original TRY species name:</span>

<span class="n">iNat_TRY_syn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">iNat_rest</span><span class="p">,</span> <span class="n">TRY_syn</span><span class="p">,</span> 
                    <span class="n">left_on</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;scientificName&#39;</span><span class="p">],</span>
                    <span class="n">right_on</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SpeciesName&#39;</span><span class="p">],</span> 
                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">iNat_TRY_syn</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>scientificName</th>
      <th>decimalLatitude</th>
      <th>decimalLongitude</th>
      <th>eventDate</th>
      <th>dateIdentified</th>
      <th>SpeciesName</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>...</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1802610589</td>
      <td>Blitum capitatum</td>
      <td>40.320259</td>
      <td>-105.604856</td>
      <td>2013-08-24T13:30:00</td>
      <td>2019-09-02T01:11:54</td>
      <td>Blitum capitatum</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.45</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2283078677</td>
      <td>Blitum capitatum</td>
      <td>50.744232</td>
      <td>-120.511303</td>
      <td>2019-06-29T17:50:28</td>
      <td>2019-09-02T01:16:41</td>
      <td>Blitum capitatum</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.45</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2864818488</td>
      <td>Blitum capitatum</td>
      <td>53.938056</td>
      <td>-106.068553</td>
      <td>2020-08-22T12:22:09</td>
      <td>2020-08-22T19:13:24</td>
      <td>Blitum capitatum</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.45</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows Ã 25 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">iNat_TRY</span><span class="p">,</span> <span class="n">iNat_TRY_syn</span><span class="p">]</span>

<span class="n">iNat_TRY_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subsets</span><span class="p">)</span>
<span class="n">iNat_TRY_all</span> <span class="o">=</span> <span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;AccSpeciesName&#39;</span><span class="p">,</span> <span class="s1">&#39;SpeciesName&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace infinite values as NaN</span>

<span class="n">iNat_TRY_all</span> <span class="o">=</span> <span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">iNat_TRY_all</span> <span class="o">=</span> <span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>scientificName</th>
      <th>decimalLatitude</th>
      <th>decimalLongitude</th>
      <th>eventDate</th>
      <th>dateIdentified</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>Leaf C</th>
      <th>...</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1229615436</td>
      <td>Commelina communis</td>
      <td>35.987483</td>
      <td>-79.057546</td>
      <td>2013-07-07T00:00:00</td>
      <td>2013-07-07T20:33:11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3384000233</td>
      <td>Commelina communis</td>
      <td>42.093762</td>
      <td>-75.923660</td>
      <td>2021-08-23T13:06:06</td>
      <td>2021-09-17T21:15:37</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1807276585</td>
      <td>Commelina communis</td>
      <td>40.787636</td>
      <td>-73.933728</td>
      <td>2017-09-04T12:47:58</td>
      <td>2017-09-04T21:58:57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3355124418</td>
      <td>Commelina communis</td>
      <td>39.643158</td>
      <td>-76.764245</td>
      <td>2020-08-26T10:19:56</td>
      <td>2020-08-27T13:21:22</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1802638502</td>
      <td>Commelina communis</td>
      <td>43.109505</td>
      <td>1.622543</td>
      <td>2017-10-21T10:01:00</td>
      <td>2017-10-21T09:02:42</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>12.631579</td>
      <td>1.71</td>
      <td>NaN</td>
      <td>8.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 24 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trait</span> <span class="o">=</span> <span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>

<span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">trait</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">iNat_TRY_all</span><span class="p">[</span><span class="n">trait</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/net/home/swolf/.conda/envs/traitmaps/lib/python3.8/site-packages/pandas/core/internals/blocks.py:402: RuntimeWarning: divide by zero encountered in log
  result = func(self.values, **kwargs)
/net/home/swolf/.conda/envs/traitmaps/lib/python3.8/site-packages/pandas/core/internals/blocks.py:402: RuntimeWarning: invalid value encountered in log
  result = func(self.values, **kwargs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;iNat_TRY_log.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">iNat_TRY_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>scientificName</th>
      <th>decimalLatitude</th>
      <th>decimalLongitude</th>
      <th>eventDate</th>
      <th>dateIdentified</th>
      <th>Dispersal unit length</th>
      <th>Leaf Area</th>
      <th>SLA</th>
      <th>Leaf C</th>
      <th>...</th>
      <th>Leaf delta15N</th>
      <th>Leaf N P ratio</th>
      <th>Leaf P</th>
      <th>Plant Height</th>
      <th>Seed mass</th>
      <th>Seed length</th>
      <th>Seeds per rep. unit</th>
      <th>Stem conduit density</th>
      <th>SSD</th>
      <th>Conduit element length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1229615436</td>
      <td>Commelina communis</td>
      <td>35.987483</td>
      <td>-79.057546</td>
      <td>2013-07-07T00:00:00</td>
      <td>2013-07-07T20:33:11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.5362</td>
      <td>0.536493</td>
      <td>NaN</td>
      <td>2.13771</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3384000233</td>
      <td>Commelina communis</td>
      <td>42.093762</td>
      <td>-75.923660</td>
      <td>2021-08-23T13:06:06</td>
      <td>2021-09-17T21:15:37</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.5362</td>
      <td>0.536493</td>
      <td>NaN</td>
      <td>2.13771</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1807276585</td>
      <td>Commelina communis</td>
      <td>40.787636</td>
      <td>-73.933728</td>
      <td>2017-09-04T12:47:58</td>
      <td>2017-09-04T21:58:57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.5362</td>
      <td>0.536493</td>
      <td>NaN</td>
      <td>2.13771</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3355124418</td>
      <td>Commelina communis</td>
      <td>39.643158</td>
      <td>-76.764245</td>
      <td>2020-08-26T10:19:56</td>
      <td>2020-08-27T13:21:22</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.5362</td>
      <td>0.536493</td>
      <td>NaN</td>
      <td>2.13771</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1802638502</td>
      <td>Commelina communis</td>
      <td>43.109505</td>
      <td>1.622543</td>
      <td>2017-10-21T10:01:00</td>
      <td>2017-10-21T09:02:42</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.5362</td>
      <td>0.536493</td>
      <td>NaN</td>
      <td>2.13771</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 24 columns</p>
</div></div></div>
</div>
<p>After matching with consolidated and original name, we were able to match about 84% of the iNaturalist observations with trait information. Many rare species seem to be absent in either one of the two databases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;percentage of iNat observations linked with at least one TRY trait:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iNat_TRY_all</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iNat</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;percentage of species in iNaturalist matched with TRY:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iNat_TRY_all</span><span class="p">[</span><span class="s2">&quot;scientificName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">/</span><span class="n">iNat</span><span class="p">[</span><span class="s2">&quot;scientificName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>percentage of iNat observations linked with at least one TRY trait:
0.8421341704587321
percentage of species in iNaturalist matched with TRY:
0.3059127945386479
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2.1_Jupyter_Data_Analysis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Analysis in Jupyter Notebook (Part 2)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3.1_Reuse_Course_Material.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reuse of winter school practical course material</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Sophie Wolf<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>